<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1"> 

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"> 

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style> 
body { 
background-color: #f8f9fa; 
} 
.section-title { 
margin-top: 60px; 
margin-bottom: 30px; 
} 
footer { 
margin-top: 60px; 
padding: 20px 0; 
background-color: #212529; 
color: white; 
} 
</style> 
</head> 
<body> 

<nav class="navbar navbar-expand-lg navbar-dark bg-dark"> 
<div class="container"> 
<a class="navbar-brand" href="#">NOE Project</a> 
</div> 
</nav> 

<div class="container"> 

<h1 class="text-center mt-5">Nature of Enterprise project- By Adam O'Connor Kenny, TJ Ermitano, Abdul Lafiaji, Micheal Juna and Jack Kells</h1> 
<p class="lead text-center">The effects of screentime on students</p> 

 
<h2 class="section-title">Dataset Overview</h2> 
<p> 
The dataset shows that there is a positive corrilation between how many hours you spend daily on a phone, and how little hours of sleep you get. The graphs also show that the more sleep students got lead to a higher mental health score, with the same being true for the more screentime leading to a higher addiction score.
</p> 

<div class="row text-center"> 
<div class="col-md-4"> 
<div class="card shadow-sm"> 
<div class="card-body"> 
<h5>Mean Screentime </h5> 
<p id="meanValue" class="display-6">--</p> 
</div> 
</div> 
</div> 
<div class="col-md-4"> 
<div class="card shadow-sm"> 
<div class="card-body"> 
<h5>Median Screentime </h5> 
<p id="medianValue" class="display-6">--</p> 
</div> 
</div> 
</div> 
<div class="col-md-4"> 
<div class="card shadow-sm"> 
<div class="card-body"> 
<h5>Standard Deviation of Screentime</h5> 
<p id="stdValue" class="display-6">--</p> 
</div> 
</div> 
</div> 
</div> 

<h2 class="section-title">Data Visualisation</h2> 
<div class="row"> 
<div class="col-md-6"> 
<canvas id="barChart"></canvas> 
</div> 
<div class="col-md-6"> 
<canvas id="lineChart"></canvas> 
</div> 
</div> 
<h2 class="section-title">Machine Learning Model</h2> 
<p> 
Placeholder </p> 

<canvas id="mlChart"></canvas> 

</div> 

<footer class="text-center"> 
<div class="container"> 

</div> 
</footer> 


<script>
async function loadExcel() {
    try {
        // ==== CHANGE THIS TO YOUR RAW GITHUB URL ====
        const rawUrl = "https://raw.githubusercontent.com/Adam28102006/HTML-Charts/main/Book.xlsx";

        // Fetch Excel file
        const response = await fetch(rawUrl);
        if (!response.ok) throw new Error("Failed to fetch Excel file");

        const data = await response.arrayBuffer();
        const workbook = XLSX.read(data, { type: "array" });

        // First sheet
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];

        // Convert to array of rows
        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        console.log("First 5 rows:", jsonData.slice(0,5));

        // Column indices (0-based)
        const screenColIndex = 4; // Column E = Screentime
        const sleepColIndex = 7;  // Column H = Sleep

        const screenData = [];
        const sleepData = [];

        // Extract vertical columns, skip empty rows
        for (let i = 1; i < jsonData.length; i++) { // skip header
            const row = jsonData[i];
            if (!row) continue;

            const screenVal = row[screenColIndex];
            const sleepVal = row[sleepColIndex];

            if (screenVal !== undefined && sleepVal !== undefined) {
                const screenNum = Number(screenVal);
                const sleepNum = Number(sleepVal);

                if (!isNaN(screenNum) && !isNaN(sleepNum)) {
                    screenData.push(screenNum);
                    sleepData.push(sleepNum);
                }
            }
        }

        console.log("Screen Data:", screenData);
        console.log("Sleep Data:", sleepData);

        if (screenData.length === 0 || sleepData.length === 0) {
            console.error("No valid data found in the specified columns!");
            return;
        }

        // Update stats
        updateStatistics(screenData);

        // Create scatter chart
        createScatterChart(sleepData, screenData);

    } catch (err) {
        console.error("Error loading Excel file:", err);
    }
}

// === Statistics functions ===
function mean(arr) { return arr.reduce((a,b)=>a+b,0)/arr.length; }
function median(arr) {
    const sorted = [...arr].sort((a,b)=>a-b);
    const mid = Math.floor(sorted.length/2);
    return arr.length % 2 !== 0 ? sorted[mid] : (sorted[mid-1]+sorted[mid])/2;
}
function stdDev(arr) {
    const m = mean(arr);
    return Math.sqrt(arr.reduce((sq,n)=>sq+Math.pow(n-m,2),0)/arr.length);
}
function updateStatistics(data) {
    document.getElementById("meanValue").innerText = mean(data).toFixed(2);
    document.getElementById("medianValue").innerText = median(data).toFixed(2);
    document.getElementById("stdValue").innerText = stdDev(data).toFixed(2);
}

// === Scatter chart ===
function createScatterChart(xData, yData) {
    new Chart(document.getElementById("barChart"), {
        type: "scatter",
        data: {
            datasets: [{
                label: "Sleep vs Screentime",
                data: xData.map((x,i)=>({x:x, y:yData[i]})),
                backgroundColor: "rgba(255, 99, 132, 0.7)"
            }]
        },
        options: {
            scales: {
                x: { title: { display:true, text:"Sleep Hours Per Night" } },
                y: { title: { display:true, text:"Average Screentime (Hours)" } }
            }
        }
    });
}


loadExcel();
</script>

</body> 
</html>

